{"paragraphs":[{"text":"import org.apache.commons.io.IOUtils\nimport java.net.URL\nimport java.nio.charset.Charset\n\nimport com.google.cloud.hadoop.io.bigquery.BigQueryConfiguration\nimport com.google.cloud.hadoop.io.bigquery.BigQueryFileFormat\nimport com.google.cloud.hadoop.io.bigquery.GsonBigQueryInputFormat\nimport com.google.cloud.hadoop.io.bigquery.output.BigQueryOutputConfiguration\nimport com.google.cloud.hadoop.io.bigquery.output.IndirectBigQueryOutputFormat\nimport com.google.gson.JsonObject\nimport org.apache.hadoop.io.LongWritable\nimport org.apache.hadoop.mapreduce.lib.output.TextOutputFormat\n","dateUpdated":"2017-10-12T14:33:35+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.commons.io.IOUtils\n\nimport java.net.URL\n\nimport java.nio.charset.Charset\n\nimport com.google.cloud.hadoop.io.bigquery.BigQueryConfiguration\n\nimport com.google.cloud.hadoop.io.bigquery.BigQueryFileFormat\n\nimport com.google.cloud.hadoop.io.bigquery.GsonBigQueryInputFormat\n\nimport com.google.cloud.hadoop.io.bigquery.output.BigQueryOutputConfiguration\n\nimport com.google.cloud.hadoop.io.bigquery.output.IndirectBigQueryOutputFormat\n\nimport com.google.gson.JsonObject\n\nimport org.apache.hadoop.io.LongWritable\n\nimport org.apache.hadoop.mapreduce.lib.output.TextOutputFormat\n"}]},"apps":[],"jobName":"paragraph_1507818808301_-428787282","id":"20170927-202627_970177482","dateCreated":"2017-10-12T14:33:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:361","user":"anonymous","dateFinished":"2017-10-12T14:34:03+0000","dateStarted":"2017-10-12T14:33:35+0000"},{"text":"@transient\r\nval conf = sc.hadoopConfiguration\r\n\r\n// Input parameters.\r\nval fullyQualifiedInputTableId = \"mortgage-data-warehouse:FHLMC.FHLMC_orig_46m\" //\"mortgage-data-warehouse:GNMAI.GNMAI_H\"  \r\nval projectId = conf.get(\"fs.gs.project.id\")\r\nval bucket = conf.get(\"fs.gs.system.bucket\")\r\n\r\n// Input configuration.\r\nconf.set(BigQueryConfiguration.PROJECT_ID_KEY, projectId)\r\nconf.set(BigQueryConfiguration.GCS_BUCKET_KEY, bucket)\r\nBigQueryConfiguration.configureBigQueryInput(conf, fullyQualifiedInputTableId)\r\n\r\n// Load data from BigQuery.\r\nval tableData = sc.newAPIHadoopRDD(\r\n    conf,\r\n    classOf[GsonBigQueryInputFormat],\r\n    classOf[LongWritable],\r\n    classOf[JsonObject]).cache\r\n\r\nval fileData = sc.textFile(\"gs://\" + projectId + \"/FHLMC/FHLMC_all_46m/fhlmc46m_*.csv\")\r\n\r\n// Output parameters.\r\nval outputTableId = projectId + \":FHLMC.test_output\"\r\n// Temp output bucket that is deleted upon completion of job.\r\nval outputGcsPath = (\"gs://\" + bucket + \"/hadoop/tmp/bigquery/testoutput\")\r\n\r\n// Output configuration.\r\n// Let BigQueery auto-detect output schema (set to null below).\r\nBigQueryOutputConfiguration.configure(conf,\r\n                                      outputTableId,\r\n                                      null,\r\n                                      outputGcsPath,\r\n                                      BigQueryFileFormat.NEWLINE_DELIMITED_JSON,\r\n                                      classOf[TextOutputFormat[_,_]])\r\n\r\nconf.set(\"mapreduce.job.outputformat.class\",\r\n         classOf[IndirectBigQueryOutputFormat[_,_]].getName)\r\n\r\n// Truncate the table before writing output to allow multiple runs.\r\nconf.set(BigQueryConfiguration.OUTPUT_TABLE_WRITE_DISPOSITION_KEY,\r\n         \"WRITE_TRUNCATE\")\r\n\r\n// Helper to convert JsonObjects to (loan, age) tuples.\r\ndef convertToTuple(record: JsonObject) : (String, Option[Long]) = {\r\n  val loan = record.get(\"Loan_Num_Q\").getAsString //.toLowerCase\r\n  val rate = if (record.has(\"Age_Q\")) Some(record.get(\"Age_Q\").getAsLong) else None\r\n  return (loan, rate)\r\n}\r\n\r\n// Helper to convert (word, count) tuples to JsonObjects.\r\n//import com.google.gson.JsonNull\r\ndef convertToJson(pair: (String, Option[Long])) : JsonObject = {\r\n  val loan = pair._1\r\n  val count = pair._2\r\n  val jsonObject = new JsonObject()\r\n  jsonObject.addProperty(\"loan_num\", loan)\r\n//  if(count != None) jsonObject.addProperty(\"noterate_count\", count.get) else jsonObject.add(\"noterate_count\", JsonNull.INSTANCE)\r\n  count.foreach(jsonObject.addProperty(\"noterate_count\", _))\r\n  return jsonObject\r\n}\r\n\r\n\r\nval loanCounts = tableData\r\n        .map(entry => convertToTuple(entry._2))\r\n        .repartition(30)\r\n//        .groupByKey()\r\n//        .reduceByKey(_ + _)\r\n//      .map(entry => {\r\n//            val loan = entry._2.get(\"Loan_Num_Q\").getAsString.toLowerCase\r\n//            val age  = entry._2.get(\"Age_Q\").getAsLong\r\n//            (loan, age)\r\n//          (entry._2.get(\"Loan_Num_Q\").getAsString, entry._2.get(\"Age_Q\").getAsLong)\r\n//      })\r\n//      .map(entry => entry._2.getClass)\r\n\r\n//print(tableDatatext.getClass)\r\n\r\n\r\n//loanCounts.partitions.size    \r\nloanCounts.keys.take(20) //.foreach(l => println(l))      \r\nloanCounts.values.take(20) //.foreach(l => println(l))      \r\n      \r\n\r\n//    ----------------------- Test functionality -------------------------------\r\n//val x = sc.parallelize(Array((\"1501052587\",4500L), (\"1501052581\",4500L), (\"1023599344\",13000L)))\r\n//println(x.collect().mkString(\", \"))\r\n//    (x.map(pair => (null, convertToJson(pair)))\r\n//    .saveAsNewAPIHadoopDataset(conf))\r\n\r\n\r\n\r\n\r\n// Write data back into a new BigQuery table.\r\n// IndirectBigQueryOutputFormat discards keys, so set key to null.\r\n/*\r\n(loanCounts\r\n    .map(pair => (null, convertToJson(pair)))\r\n    .saveAsNewAPIHadoopDataset(conf))\r\n*/\r\n\r\n","dateUpdated":"2017-10-12T14:42:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{"0":{"graph":{"mode":"table","height":365.2,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nconf: org.apache.hadoop.conf.Configuration = Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/etc/hive/conf.dist/hive-site.xml\n\nfullyQualifiedInputTableId: String = mortgage-data-warehouse:FHLMC.FHLMC_orig_46m\n\nprojectId: String = mortgage-data-warehouse\n\nbucket: String = dataproc-8adad88a-330a-4cbd-9a69-57e1d2afdebd-us\n\ntableData: org.apache.spark.rdd.RDD[(org.apache.hadoop.io.LongWritable, com.google.gson.JsonObject)] = NewHadoopRDD[0] at newAPIHadoopRDD at <console>:40\n\nfileData: org.apache.spark.rdd.RDD[String] = gs://mortgage-data-warehouse/FHLMC/FHLMC_all_46m/fhlmc46m_*.csv MapPartitionsRDD[2] at textFile at <console>:42\n\noutputTableId: String = mortgage-data-warehouse:FHLMC.test_output\n\noutputGcsPath: String = gs://dataproc-8adad88a-330a-4cbd-9a69-57e1d2afdebd-us/hadoop/tmp/bigquery/testoutput\n\nconvertToTuple: (record: com.google.gson.JsonObject)(String, Option[Long])\n\nconvertToJson: (pair: (String, Option[Long]))com.google.gson.JsonObject\n\nloanCounts: org.apache.spark.rdd.RDD[(String, Option[Long])] = MapPartitionsRDD[7] at repartition at <console>:46\n\nres6: Array[String] = Array(F106Q4044751, F102Q1086294, F108Q2088189, F101Q2172679, F199Q4080330, F111Q2144547, F199Q2071695, F106Q3063136, F101Q2009529, F199Q2259205, F100Q2061852, F107Q1240117, F106Q4041291, F101Q3006548, F106Q3167574, F199Q1343058, F101Q3037015, F100Q2099826, F100Q4113329, F102Q2264494)\n\nres7: Array[Option[Long]] = Array(Some(21), Some(56), Some(12), Some(31), Some(102), Some(72), Some(28), Some(13), Some(79), Some(24), Some(73), Some(8), Some(50), Some(21), Some(33), Some(53), Some(13), Some(2), Some(20), Some(15))\n"}]},"apps":[],"jobName":"paragraph_1507818808304_-417629564","id":"20170927-202629_634302269","dateCreated":"2017-10-12T14:33:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:362","user":"anonymous","dateFinished":"2017-10-12T14:51:06+0000","dateStarted":"2017-10-12T14:42:28+0000"},{"text":"//tableData.take(10).foreach(entry => print(entry.getClass))\nprint(tableData.getClass)\nprint(fileData.getClass)\n\nval fhlmc46m = spark.read.option(\"header\", \"true\").csv(\"gs://\" + projectId + \"/FHLMC/FHLMC_all_46m/fhlmc46m_*.csv\")\nval fileData = sc.textFile(\"gs://\" + projectId + \"/FHLMC/FHLMC_all_46m/fhlmc46m_*.csv\")\n\n\nprint(fhlmc46m.getClass)\nprint(fileData.getClass)\n\nfileData.toDF.printSchema\nfhlmc46m.printSchema\n\n//fileData.toDF.show\nfhlmc46m.show\n\n\n//filetest.select(\"Loan_num_q\").write.csv(\"gs://\" + projectId + \"/FHLMC\n\n/*\nval test = spark.read.json(test0).cache\ntest.printSchema\n*/\n","dateUpdated":"2017-10-12T16:34:52+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"class org.apache.spark.rdd.NewHadoopRDDclass org.apache.spark.rdd.MapPartitionsRDD\nfhlmc46m: org.apache.spark.sql.DataFrame = [As_Of_Dt_Q: string, Zero_Bal_Dt_Q: string ... 46 more fields]\n\nfileData: org.apache.spark.rdd.RDD[String] = gs://mortgage-data-warehouse/FHLMC/FHLMC_all_46m/fhlmc46m_*.csv MapPartitionsRDD[134] at textFile at <console>:42\nclass org.apache.spark.sql.Datasetclass org.apache.spark.rdd.MapPartitionsRDDroot\n |-- value: string (nullable = true)\n\nroot\n |-- As_Of_Dt_Q: string (nullable = true)\n |-- Zero_Bal_Dt_Q: string (nullable = true)\n |-- Int_Paid_To_Dt_Q: string (nullable = true)\n |-- Loan_Num_Q: string (nullable = true)\n |-- UPB_Q: string (nullable = true)\n |-- Delinquency_Info_Status_Q: string (nullable = true)\n |-- Age_Q: string (nullable = true)\n |-- Rem_Term_Q: string (nullable = true)\n |-- Repurchase_Flag_Q: string (nullable = true)\n |-- Mod_Flag_Q: string (nullable = true)\n |-- Exit_Event_Q: string (nullable = true)\n |-- Note_Rate_Q: string (nullable = true)\n |-- UPB_Deferred_Q: string (nullable = true)\n |-- Recoveries_MI_Q: string (nullable = true)\n |-- Net_Liquidation_Proceeds_Text_Q: string (nullable = true)\n |-- Recoveries_Non_MI_Q: string (nullable = true)\n |-- Cost_Total_Q: string (nullable = true)\n |-- Cost_Legal_Q: string (nullable = true)\n |-- Cost_Maint_Preserv_Q: string (nullable = true)\n |-- Cost_TI_Q: string (nullable = true)\n |-- Cost_Misc_Q: string (nullable = true)\n |-- Loss_Amt_Q: string (nullable = true)\n |-- Mod_Cost_Q: string (nullable = true)\n |-- FICO_Orig_Q: string (nullable = true)\n |-- First_Pmt_Dt_Q: string (nullable = true)\n |-- First_Time_Buyer_Q: string (nullable = true)\n |-- Maturity_Dt_Q: string (nullable = true)\n |-- MSA_Q: string (nullable = true)\n |-- MI_Percentage_Q: string (nullable = true)\n |-- Num_Units_Q: string (nullable = true)\n |-- Owner_Occup_Q: string (nullable = true)\n |-- LTV_Combined_Orig_Q: string (nullable = true)\n |-- DTI_Orig_Q: string (nullable = true)\n |-- Orig_Bal_Q: string (nullable = true)\n |-- LTV_Orig_Q: string (nullable = true)\n |-- Orig_Rate_Q: string (nullable = true)\n |-- Channel_Q: string (nullable = true)\n |-- PrePay_Penalty_Flag_Q: string (nullable = true)\n |-- Amort_Type_Q: string (nullable = true)\n |-- State_Q: string (nullable = true)\n |-- Prop_Type_Q: string (nullable = true)\n |-- Zip_Code_Q: string (nullable = true)\n |-- Loan_Purpose_Q: string (nullable = true)\n |-- Orig_Term_Q: string (nullable = true)\n |-- Num_of_Borrowers_Q: string (nullable = true)\n |-- Seller_Name_Q: string (nullable = true)\n |-- Servicer_Q: string (nullable = true)\n |-- Conforming_Flag_Q: string (nullable = true)\n\n+----------+-------------+----------------+------------+---------+-------------------------+-----+----------+-----------------+----------+------------+-----------+--------------+---------------+-------------------------------+-------------------+------------+------------+--------------------+---------+-----------+----------+----------+-----------+--------------+------------------+-------------+-----+---------------+-----------+-------------+-------------------+----------+----------+----------+-----------+---------+---------------------+------------+-------+-----------+----------+--------------+-----------+------------------+--------------------+--------------------+-----------------+\n|As_Of_Dt_Q|Zero_Bal_Dt_Q|Int_Paid_To_Dt_Q|  Loan_Num_Q|    UPB_Q|Delinquency_Info_Status_Q|Age_Q|Rem_Term_Q|Repurchase_Flag_Q|Mod_Flag_Q|Exit_Event_Q|Note_Rate_Q|UPB_Deferred_Q|Recoveries_MI_Q|Net_Liquidation_Proceeds_Text_Q|Recoveries_Non_MI_Q|Cost_Total_Q|Cost_Legal_Q|Cost_Maint_Preserv_Q|Cost_TI_Q|Cost_Misc_Q|Loss_Amt_Q|Mod_Cost_Q|FICO_Orig_Q|First_Pmt_Dt_Q|First_Time_Buyer_Q|Maturity_Dt_Q|MSA_Q|MI_Percentage_Q|Num_Units_Q|Owner_Occup_Q|LTV_Combined_Orig_Q|DTI_Orig_Q|Orig_Bal_Q|LTV_Orig_Q|Orig_Rate_Q|Channel_Q|PrePay_Penalty_Flag_Q|Amort_Type_Q|State_Q|Prop_Type_Q|Zip_Code_Q|Loan_Purpose_Q|Orig_Term_Q|Num_of_Borrowers_Q|       Seller_Name_Q|          Servicer_Q|Conforming_Flag_Q|\n+----------+-------------+----------------+------------+---------+-------------------------+-----+----------+-----------------+----------+------------+-----------+--------------+---------------+-------------------------------+-------------------+------------+------------+--------------------+---------+-----------+----------+----------+-----------+--------------+------------------+-------------+-----+---------------+-----------+-------------+-------------------+----------+----------+----------+-----------+---------+---------------------+------------+-------+-----------+----------+--------------+-----------+------------------+--------------------+--------------------+-----------------+\n|2014-02-01|         null|            null|F113Q1345744|231848.59|                        0|   12|       168|             null|      null|        null|      3.125|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        717|    2013-03-01|              null|   2028-02-01|35614|              0|          1|            O|                 67|        35|    245000|        31|      3.125|        R|                    N|         FRM|     NY|         SF|     10500|             N|        180|                 2|       Other sellers|     Other servicers|             null|\n|2013-12-01|         null|            null|F113Q1345744|234043.77|                        0|   10|       170|             null|      null|        null|      3.125|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        717|    2013-03-01|              null|   2028-02-01|35614|              0|          1|            O|                 67|        35|    245000|        31|      3.125|        R|                    N|         FRM|     NY|         SF|     10500|             N|        180|                 2|       Other sellers|     Other servicers|             null|\n|2003-10-01|   2003-10-01|            null|F100Q3121540|        0|                        0|   38|       322|                N|      null|          01|       8.25|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|         0|        796|    2000-09-01|                 Y|   2030-08-01|12420|             25|          1|            O|                 93|        30|     88000|        93|       8.25|        R|                    N|         FRM|     TX|         SF|     78600|             P|        360|                 1|    BANKOFAMERICA,NA|    BANKOFAMERICA,NA|             null|\n|2001-05-01|         null|            null|F100Q3121540| 87132.87|                        0|    9|       351|             null|      null|        null|       8.25|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        796|    2000-09-01|                 Y|   2030-08-01|12420|             25|          1|            O|                 93|        30|     88000|        93|       8.25|        R|                    N|         FRM|     TX|         SF|     78600|             P|        360|                 1|    BANKOFAMERICA,NA|    BANKOFAMERICA,NA|             null|\n|2000-10-01|         null|            null|F100Q3121540|    88000|                        0|    2|       358|             null|      null|        null|       8.25|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        796|    2000-09-01|                 Y|   2030-08-01|12420|             25|          1|            O|                 93|        30|     88000|        93|       8.25|        R|                    N|         FRM|     TX|         SF|     78600|             P|        360|                 1|    BANKOFAMERICA,NA|    BANKOFAMERICA,NA|             null|\n|2000-12-01|         null|            null|F100Q3121540|    87000|                        0|    4|       356|             null|      null|        null|       8.25|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        796|    2000-09-01|                 Y|   2030-08-01|12420|             25|          1|            O|                 93|        30|     88000|        93|       8.25|        R|                    N|         FRM|     TX|         SF|     78600|             P|        360|                 1|    BANKOFAMERICA,NA|    BANKOFAMERICA,NA|             null|\n|2001-08-01|         null|            null|F100Q3121540| 86953.29|                        0|   12|       348|             null|      null|        null|       8.25|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        796|    2000-09-01|                 Y|   2030-08-01|12420|             25|          1|            O|                 93|        30|     88000|        93|       8.25|        R|                    N|         FRM|     TX|         SF|     78600|             P|        360|                 1|    BANKOFAMERICA,NA|    BANKOFAMERICA,NA|             null|\n|2001-06-01|         null|            null|F100Q1053253|141200.87|                        0|   14|       346|             null|      null|        null|       8.75|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        770|    2000-05-01|                 Y|   2030-04-01|33460|             18|          1|            O|                 97|        49|    143000|        97|       8.75|        T|                    N|         FRM|     MN|         SF|     55000|             P|        360|                 2| NORWESTMORTGAGE,INC|WELLSFARGOHOMEMORTGA|             null|\n|2000-06-01|         null|            null|F100Q1053253|   142000|                        0|    2|       358|             null|      null|        null|       8.75|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        770|    2000-05-01|                 Y|   2030-04-01|33460|             18|          1|            O|                 97|        49|    143000|        97|       8.75|        T|                    N|         FRM|     MN|         SF|     55000|             P|        360|                 2| NORWESTMORTGAGE,INC|WELLSFARGOHOMEMORTGA|             null|\n|2000-12-01|         null|            null|F100Q1053253|141844.22|                        0|    8|       352|             null|      null|        null|       8.75|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        770|    2000-05-01|                 Y|   2030-04-01|33460|             18|          1|            O|                 97|        49|    143000|        97|       8.75|        T|                    N|         FRM|     MN|         SF|     55000|             P|        360|                 2| NORWESTMORTGAGE,INC|WELLSFARGOHOMEMORTGA|             null|\n|2001-07-01|         null|            null|F100Q1053253|141066.27|                        0|   15|       345|             null|      null|        null|       8.75|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        770|    2000-05-01|                 Y|   2030-04-01|33460|             18|          1|            O|                 97|        49|    143000|        97|       8.75|        T|                    N|         FRM|     MN|         SF|     55000|             P|        360|                 2| NORWESTMORTGAGE,INC|WELLSFARGOHOMEMORTGA|             null|\n|2001-01-01|         null|            null|F100Q4127037|   138000|                        0|    1|       359|             null|      null|        null|       8.25|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        609|    2001-01-01|              null|   2030-12-01|16974|             12|          1|            O|                 82|        17|    138000|        82|       8.25|        T|                    N|         FRM|     IL|         SF|     60800|             N|        360|                 2|PNCMTGECORPOFAMERICA|     Other servicers|             null|\n|2007-12-01|         null|            null|F107Q3067454|   101000|                        0|    3|       357|             null|      null|        null|       6.99|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        690|    2007-10-01|                 N|   2037-09-01|16700|             12|          1|            O|                 83|        32|    101000|        83|       6.99|        T|                    N|         FRM|     SC|         SF|     29400|             C|        360|                 1|         COUNTRYWIDE|         COUNTRYWIDE|             null|\n|2001-09-01|         null|            null|F199Q4070618|201229.76|                        0|   20|       340|             null|      null|        null|          8|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        668|    2000-02-01|                 N|   2030-01-01|47894|             18|          1|            O|                 97|        41|    204000|        97|          8|        T|                    N|         FRM|     VA|         PU|     20100|             P|        360|                 2| NORWESTMORTGAGE,INC|WELLSFARGOHOMEMORTGA|             null|\n|2001-07-01|         null|            null|F199Q4070618|201539.55|                        0|   18|       342|             null|      null|        null|          8|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        668|    2000-02-01|                 N|   2030-01-01|47894|             18|          1|            O|                 97|        41|    204000|        97|          8|        T|                    N|         FRM|     VA|         PU|     20100|             P|        360|                 2| NORWESTMORTGAGE,INC|WELLSFARGOHOMEMORTGA|             null|\n|2015-08-01|         null|            null|F115Q2033272|   413000|                        0|    3|       357|             null|      null|        null|        4.2|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        793|    2015-06-01|              null|   2045-05-01|41940|              0|          1|            O|                 28|        42|    417000|        28|        4.2|        B|                    N|         FRM|     CA|         SF|     95000|             C|        360|                 2|       Other sellers|     Other servicers|             null|\n|2005-07-01|         null|            null|F102Q1355518|145947.61|                        0|   41|       319|             null|      null|        null|      7.625|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        300|    2002-03-01|                 N|   2032-02-01|12420|             18|          1|            O|                 94|        40|    151000|        94|      7.625|        R|                    N|         FRM|     TX|         SF|     78700|             N|        360|                 2|      NATLCITYMTGECO|      NATLCITYMTGECO|             null|\n|2002-08-01|         null|            null|F102Q1355518|   150000|                        0|    6|       354|             null|      null|        null|      7.625|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        300|    2002-03-01|                 N|   2032-02-01|12420|             18|          1|            O|                 94|        40|    151000|        94|      7.625|        R|                    N|         FRM|     TX|         SF|     78700|             N|        360|                 2|      NATLCITYMTGECO|      NATLCITYMTGECO|             null|\n|2004-12-01|         null|            null|F102Q1355518|146915.16|                        0|   34|       326|             null|      null|        null|      7.625|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        300|    2002-03-01|                 N|   2032-02-01|12420|             18|          1|            O|                 94|        40|    151000|        94|      7.625|        R|                    N|         FRM|     TX|         SF|     78700|             N|        360|                 2|      NATLCITYMTGECO|      NATLCITYMTGECO|             null|\n|2003-10-01|         null|            null|F102Q1355518|148726.16|                        0|   20|       340|             null|      null|        null|      7.625|             0|           null|                           null|               null|        null|        null|                null|     null|       null|      null|      null|        300|    2002-03-01|                 N|   2032-02-01|12420|             18|          1|            O|                 94|        40|    151000|        94|      7.625|        R|                    N|         FRM|     TX|         SF|     78700|             N|        360|                 2|      NATLCITYMTGECO|      NATLCITYMTGECO|             null|\n+----------+-------------+----------------+------------+---------+-------------------------+-----+----------+-----------------+----------+------------+-----------+--------------+---------------+-------------------------------+-------------------+------------+------------+--------------------+---------+-----------+----------+----------+-----------+--------------+------------------+-------------+-----+---------------+-----------+-------------+-------------------+----------+----------+----------+-----------+---------+---------------------+------------+-------+-----------+----------+--------------+-----------+------------------+--------------------+--------------------+-----------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1507818808305_-418014313","id":"20170927-203538_9528790","dateCreated":"2017-10-12T14:33:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:363","user":"anonymous","dateFinished":"2017-10-12T16:34:55+0000","dateStarted":"2017-10-12T16:34:52+0000"},{"text":"//fileData.toDF.count()\n//fhlmc46m.count\n\nfileData.repartition(1).toDF.write.csv(\"gs://\" + projectId + \"/FHLMC/tmp/dataproc/\")\n\n//fhlmc46m.repartition(1).write.csv(\"gs://\" + projectId + \"/FHLMC/tmp/dataproc/\")","dateUpdated":"2017-10-12T14:33:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1507818808305_-418014313","id":"20171006-143419_914559290","dateCreated":"2017-10-12T14:33:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:364"},{"text":"//test.toDF().select(\"Age_Q\").show()\n//.select(\"Age_Q\").take(10).foreach(l => println(l))\nval fhlmc = test.toDF().registerTempTable(\"fhlmc\")\n\nval outputGcsPath = (\"gs://\" + projectId + \"/FHLMC/tmp/dataproc\")\n\n//val test_save = test.toDF().coalesce(1)\n//import org.apache.spark.sql.{SaveMode, SparkSession}\n//test_save.write.mode(SaveMode.Overwrite).csv(outputGcsPath + \"/hdfs/test_save.csv\")\n\n\ntest.select(\"Loan_num_q\").write.csv(\"gs://\" + projectId + \"/FHLMC/tmp/dataproc/test_ds_save.csv\")\n//test.saveAsTextFile(\"gs://\" + projectId + \"/FHLMC/tmp/dataproc\")\n\n\n","dateUpdated":"2017-10-12T14:33:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nfhlmc: Unit = ()\n\noutputGcsPath: String = gs://mortgage-data-warehouse/FHLMC/tmp/dataproc\n"}]},"apps":[],"jobName":"paragraph_1507818808306_-416860067","id":"20170929-152315_65608423","dateCreated":"2017-10-12T14:33:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:365"},{"text":"%sql \nselect age_q, count(1) value\nfrom fhlmc \ngroup by age_q","dateUpdated":"2017-10-12T14:33:28+0000","config":{"colWidth":6,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"age_q","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"value","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"age_q\tvalue\n125\t45941\n7\t924598\n51\t330140\n124\t47168\n169\t4823\n205\t773\n15\t800274\n54\t306665\n155\t14977\n132\t36508\n154\t15778\n200\t1007\n11\t868124\n101\t90896\n138\t28299\n29\t578686\n69\t219851\n112\t67070\n42\t429854\n87\t134023\n73\t196709\n64\t245082\n3\t955198\n30\t566638\n113\t65063\n34\t522031\n133\t34859\n59\t273093\n162\t8082\n146\t21663\n139\t27203\n8\t911933\n160\t9355\n22\t678402\n184\t1876\n28\t591091\n203\t853\n199\t1032\n85\t144165\n35\t511545\n16\t781986\n52\t322087\n171\t4329\n183\t2008\n0\t852846\n187\t1522\n71\t207771\n98\t98388\n188\t1462\n47\t369951\n99\t95970\n195\t1163\n110\t71260\n107\t77248\nnull\t468\n179\t2587\n96\t103057\n202\t904\n43\t417459\n5\t948034\n31\t555392\n163\t7586\n100\t93531\n18\t744319\n70\t213776\n174\t3714\n206\t713\n168\t5198\n27\t604102\n61\t260877\n75\t187215\n166\t6088\n17\t763348\n140\t26247\n131\t38009\n126\t44606\n26\t618194\n120\t52854\n46\t381539\n130\t39570\n147\t21005\n164\t7087\n207\t630\n78\t173777\n208\t525\n89\t124560\n77\t178188\n136\t30703\n198\t1055\n6\t936168\n118\t56092\n185\t1740\n201\t959\n177\t3081\n104\t83711\n90\t120411\n60\t266633\n68\t225921\n194\t1205\n19\t726522\n23\t663234\n41\t441899\n128\t42182\n102\t88461\n55\t299654\n111\t69210\n197\t1081\n167\t5580\n93\t110448\n95\t105564\n40\t453740\n38\t479166\n103\t85927\n25\t632894\n189\t1417\n44\t405062\n156\t14178\n190\t1371\n135\t31853\n144\t22970\n176\t3346\n115\t61317\n82\t156700\n193\t1249\n53\t314314\n92\t113166\n122\t49915\n108\t75239\n117\t57754\n86\t139356\n58\t279619\n204\t817\n81\t160926\n33\t533147\n114\t63034\n150\t18261\n170\t4545\n178\t2804\n48\t358664\n153\t16388\n141\t25369\n180\t2446\n148\t20256\n173\t3928\n97\t100765\n159\t10138\n209\t412\n67\t231073\n106\t79387\n158\t11382\n84\t148260\n143\t23726\n79\t169679\n24\t648088\n9\t897512\n32\t544519\n116\t59549\n152\t17021\n186\t1610\n134\t33326\n88\t129073\n1\t934708\n149\t19243\n105\t81512\n20\t710085\n142\t24521\n56\t293061\n127\t43329\n36\t501157\n211\t122\n10\t883202\n37\t490535\n165\t6597\n49\t347966\n172\t4121\n63\t249943\n181\t2314\n65\t240376\n4\t953017\n121\t51285\n39\t467031\n210\t271\n62\t255288\n12\t852249\n83\t152373\n109\t73171\n123\t48553\n13\t835703\n157\t13036\n191\t1331\n14\t818207\n21\t693797\n182\t2162\n66\t235668\n94\t108071\n91\t116555\n175\t3525\n72\t201982\n74\t191938\n137\t29554\n161\t8651\n151\t17620\n129\t40910\n76\t182633\n2\t952202\n196\t1116\n192\t1284\n80\t165480\n50\t338667\n145\t22264\n45\t393060\n57\t286209\n119\t54450\n"}]},"apps":[],"jobName":"paragraph_1507818808306_-416860067","id":"20170927-202907_282031011","dateCreated":"2017-10-12T14:33:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:366"},{"text":"%bigquery.sql\r\n#standardSQL\r\nSELECT loan_num_q, count(*) FROM `mortgage-data-warehouse.FHLMC.FHLMC_orig` \r\nwhere loan_num_q is null\r\ngroup by 1\r\n--limit 10","dateUpdated":"2017-10-12T14:33:28+0000","config":{"colWidth":6,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"SQL Execution returned an error!"}]},"apps":[],"jobName":"paragraph_1507818808307_-417244815","id":"20171005-143255_307464260","dateCreated":"2017-10-12T14:33:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:367"},{"text":"projectId","dateUpdated":"2017-10-12T14:33:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres11: String = mortgage-data-warehouse\n"}]},"apps":[],"jobName":"paragraph_1507818808308_-419168560","id":"20171005-190745_2021245556","dateCreated":"2017-10-12T14:33:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:368"},{"text":"loanCounts: org.apache.spark.rdd.RDD[(String, Long)] = ShuffledRDD[56] at reduceByKey at <console>:71\r\nres99: Array[(String, Long)] = Array((1501052587,4500), (1501052581,4500), (1023599344,13000), (1023595551,12500), (1501052592,4500), (1501052590,4500), (1501052583,4500), (1501052585,4500), (1501052589,4500), (1023595687,12500), (1501052584,4500), (1501052580,4500), (1501052586,4500), (1501052588,4500), (1501052591,4500), (1501052593,4500), (1501052582,4500), (1023598090,13000))\r\n\r\n\r\nloanCounts: org.apache.spark.rdd.RDD[(String, Long)] = MapPartitionsRDD[61] at map at <console>:69\r\nres107: Array[(String, Long)] = Array((1023595687,12500), (1023598090,13000), (1023595551,12500), (1023599344,13000), (1501052590,4500), (1501052581,4500), (1501052583,4500), (1501052582,4500), (1501052592,4500), (1501052586,4500), (1501052593,4500), (1501052585,4500), (1501052584,4500), (1501052580,4500), (1501052591,4500), (1501052587,4500), (1501052588,4500), (1501052589,4500))\r\n","dateUpdated":"2017-10-12T14:33:28+0000","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1507818808308_-419168560","id":"20171006-191023_1063959915","dateCreated":"2017-10-12T14:33:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:369"},{"text":"","dateUpdated":"2017-10-12T14:33:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"\n\n\n<console>:77: error: not found: value D\n       D\n       ^\n"}]},"apps":[],"jobName":"paragraph_1507818808309_-419553309","id":"20171007-110851_2024412243","dateCreated":"2017-10-12T14:33:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:370"},{"dateUpdated":"2017-10-12T14:33:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1507818808309_-419553309","id":"20171007-120544_1946509542","dateCreated":"2017-10-12T14:33:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:371"}],"name":"FHLMC_spark","id":"2CXRYEPVT","angularObjects":{"2CVD8JUDQ:shared_process":[],"2CWQSUQ2J:shared_process":[],"2CY5PYV2A:shared_process":[],"2CXHFMTUA:shared_process":[],"2CVAF55GK:shared_process":[],"2CWXZG8AC:shared_process":[],"2CVMYC75C:shared_process":[],"2CW7XA15G:shared_process":[],"2CV8J395X:shared_process":[],"2CXWNSPSJ:shared_process":[],"2CWTBRTU9:shared_process":[],"2CWF79VJT:shared_process":[],"2CY91EBED:shared_process":[],"2CUHVKG6M:shared_process":[],"2CVU28SZ9:shared_process":[],"2CVZHR85Y:shared_process":[],"2CVZJY2C5:shared_process":[],"2CUWWBNND:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}